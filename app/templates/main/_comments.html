<div class="border-0 border-start border-2 ps-2" id="{{comment.id}}">
  <div class="mt-3">
    <strong>{{comment.author.username}}</strong>
    {% if comment.parent_id == None %} replying to
    <strong> {{post.author.username }}</strong> {% elif
    comment.reply.author.username %}replying to
    <strong> {{ comment.reply.author.username }} </strong>{% endif %}

    <small class="text-muted"
      >{{ moment(comment.timestamp).fromNow(refresh=True) }}</small
    >
  </div>
  <div class="border p-2 rounded">
    <p>{{comment.body}}</p>
    <div class="row mx-2">
      <button
        class="btn btn-primary btn-sm col-1 rounded-pill"
        onclick="handleReply({{ comment.id }})"
      >
        Reply
      </button>
      {% if not current_user.is_anonymous %} {% if not
      current_user.comment_liked(comment) %}
      <form
        class="col-2"
        action="{{ url_for('main.like_comment', comment_id=comment.id)}}"
        method="post"
      >
        <button
          type="submit"
          value="Like"
          class="btn btn-primary btn-sm rounded-pill"
        >
          Like
          <span class="badge bg-secondary">{{comment.likes.count()}}</span>
        </button>
      </form>

      {% else %}
      <form
        action="{{ url_for('main.unlike_comment', comment_id=comment.id)}}"
        method="post"
      >
        <button type="submit" value="Unlike" class="btn btn-primary">
          Unlike
          <span class="badge bg-secondary">{{comment.likes.count()}}</span>
        </button>
      </form>
      {% endif %} {% endif %}
      <div class="col"></div>
    </div>
    {% if form %}
    <div id="reply-form-container-{{comment.id}}" style="display: none">
      <form method="post" action="{{ url_for('main.reply') }}" class="mt-3">
        {{ form.hidden_tag() }}
        <input type="hidden" name="post_id" value="{{post.id}}" />
        <input type="hidden" name="parent" value="{{comment.id}}" />
        <!-- <input
          type="hidden"
          name="post_url"
          value="{{post.get_absolute_url}}"
        /> -->

        {{ form.comment(class='form-control')}}

        <div>
          <button
            type="button"
            onclick="handleCancel({{comment.id}})"
            class="btn btn-light border btn-sm"
          >
            Cancel
          </button>
          <button type="submit" class="btn btn-primary btn-sm">Submit</button>
        </div>
      </form>
    </div>
    {% endif %}
  </div>
  <div>
    {% for reply in comment.replies %} {% with comment=reply %} {% include
    'main/_comments.html' %} {% endwith %} {% endfor %}
  </div>
</div>
